window.oc=window.oc||{};var ocanMod=angular.module("oc-angular",[]);oc.controller=function(target,controller){target.controller(controller.name,controller)};oc.appendArray=function(source,target){for(var i=0;i<source.length;i++){target.push(source[i])}};oc.append=function(source,target){console.warn("oc.append is deprecieted use oc.appendArray instead of oc.append");oc.appendArray(source,target)};oc.emptyArray=function(array){var k=array.length;while(k--){array.pop()}};oc.randomRange=function(min,max){return Math.floor(Math.random()*(max-min+1))+min};oc.trimArray=function(array,indexs){var shl=0;for(var i=0;i<indexs.length;i++){array.splice(parseInt(indexs[i])-i,1)}};oc.getRandomColor=function(){var color=new Color("#"+(Math.random().toString(16)+"0000000").slice(2,8));return"#"+((1<<24)+(color.rgb().r<<16)+(color.rgb().g<<8)+color.rgb().b).toString(16).slice(1)};oc.getRandomMetarialColor=function(exception){exception=exception||[];var color=getColor();while(exception.indexOf(color)!=-1){color=getColor()}function getColor(){var b=oc.MetarialColorSets[Object.keys(oc.MetarialColorSets)[oc.randomRange(0,Object.keys(oc.MetarialColorSets).length-1)]];return b[oc.randomRange(0,b.length-1)]}return color};oc.getScrollBarWidth=function(){var parent,child,width;if(width===undefined){parent=$('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body");child=parent.children();width=child.innerWidth()-child.height(99).innerWidth();parent.remove()}return width};oc.Svg=function(url){var _p=this;var _data=null;var _svg=null;_p.onready=null;$.get(url,function(data){_svg=data;if(_p.onready){_p.onready(_svg)}});_p.fillColor=function(color){if(!_svg){return null}$(_svg).find("svg").attr("style","fill:"+color+";")};_p.getSvgData=function(){if(!_svg){return null}return"data:image/svg+xml;charset=UTF-8;base64,"+btoa(new XMLSerializer().serializeToString(_svg))};_p.getSvg=function(){if(!_svg){return null}return _svg};_p.dispose=function(){_svg=null}};oc.generateGUID=function(){var d=new Date().getTime();var uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c=="x"?r:(r&3|8)).toString(16)});return uuid};oc.ImageComposite=function(width,height){var _p=this;var _currentProgress=0;var _totalProgress=0;var _resultCallBack=null;var _totalLayer=0;var canvas=document.createElement("canvas");canvas.width=width;canvas.height=height;var context=canvas.getContext("2d");function reset(){_resultCallBack=null;_totalProgress=0;_currentProgress=0}_p.destroy=function(){context=null;convas=null};_p.createLayer=function(image,callback){var loader=new Image();_totalProgress++;loader.onload=function(){if(callback){callback({x:0,y:0,width:this.width,height:this.height,image:this})}if(++_currentProgress>=_totalProgress){_totalProgress=0;_currentProgress=0;if(_resultCallBack){_p.getBase64(_resultCallBack);reset()}}};loader.src=image};_p.addLayer=function(layer,x,y){context.drawImage(layer.image,x,y)};_p.addSrcLayer=function(image,x,y,callback){_totalProgress++;var loader=new Image();loader.onload=function(){if(_totalLayer++==0){if(width==null){canvas.width=this.width}if(height==null){canvas.height=this.height}}context.drawImage(this,x,y);if(callback){callback({x:x,y:y,width:this.width,height:this.height,image:this})}if(++_currentProgress>=_totalProgress){_totalProgress=0;_currentProgress=0;if(_resultCallBack){_p.getBase64(_resultCallBack);reset()}}};loader.src=image};_p.getBase64=function(callback){if(_currentProgress<_totalProgress){_resultCallBack=callback;return null}else{if(callback){reset();callback(canvas.toDataURL("image/png"))}}}};oc.MetarialColorSets={red:["#F44336","#FFEBEE","#FFCDD2","#EF9A9A","#E57373","#EF5350","#F44336","#E53935","#D32F2F","#C62828","#B71C1C","#FF8A80","#FF5252","#FF1744","#D50000"],pink:["#E91E63","#FCE4EC","#F8BBD0","#F48FB1","#F06292","#EC407A","#E91E63","#D81B60","#C2185B","#AD1457","#880E4F","#FF80AB","#FF4081","#F50057","#C51162"],purple:["#9C27B0","#F3E5F5","#E1BEE7","#CE93D8","#BA68C8","#AB47BC","#9C27B0","#8E24AA","#7B1FA2","#6A1B9A","#4A148C","#EA80FC","#E040FB","#D500F9","#AA00FF"],deepPurple:["#673AB7","#EDE7F6","#D1C4E9","#B39DDB","#9575CD","#7E57C2","#673AB7","#5E35B1","#512DA8","#4527A0","#311B92","#B388FF","#7C4DFF","#651FFF","#6200EA"],indigo:["#3F51B5","#E8EAF6","#C5CAE9","#9FA8DA","#7986CB","#5C6BC0","#3F51B5","#3949AB","#303F9F","#283593","#1A237E","#8C9EFF","#536DFE","#3D5AFE","#304FFE"],blue:["#2196F3","#E3F2FD","#BBDEFB","#90CAF9","#64B5F6","#42A5F5","#2196F3","#1E88E5","#1976D2","#1565C0","#0D47A1","#82B1FF","#448AFF","#2979FF","#2962FF"],lightBlue:["#03A9F4","#E1F5FE","#B3E5FC","#81D4FA","#4FC3F7","#29B6F6","#03A9F4","#039BE5","#0288D1","#0277BD","#01579B","#80D8FF","#40C4FF","#00B0FF","#0091EA"],cyan:["#00BCD4","#E0F7FA","#B2EBF2","#80DEEA","#4DD0E1","#26C6DA","#00BCD4","#00ACC1","#0097A7","#00838F","#006064","#84FFFF","#18FFFF","#00E5FF","#00B8D4"],teal:["#009688","#E0F2F1","#B2DFDB","#80CBC4","#4DB6AC","#26A69A","#009688","#00897B","#00796B","#00695C","#004D40","#A7FFEB","#64FFDA","#1DE9B6","#00BFA5"],green:["#4CAF50","#E8F5E9","#C8E6C9","#A5D6A7","#81C784","#66BB6A","#4CAF50","#43A047","#388E3C","#2E7D32","#1B5E20","#B9F6CA","#69F0AE","#00E676","#00C853"],lightGreen:["#8BC34A","#F1F8E9","#DCEDC8","#C5E1A5","#AED581","#9CCC65","#8BC34A","#7CB342","#689F38","#558B2F","#33691E","#CCFF90","#B2FF59","#76FF03","#64DD17"],lime:["#CDDC39","#F9FBE7","#F0F4C3","#E6EE9C","#DCE775","#D4E157","#CDDC39","#C0CA33","#AFB42B","#9E9D24","#827717","#F4FF81","#EEFF41","#C6FF00","#AEEA00"],yellow:["#FFEB3B","#FFFDE7","#FFF9C4","#FFF59D","#FFF176","#FFEE58","#FFEB3B","#FDD835","#FBC02D","#F9A825","#F57F17","#FFFF8D","#FFFF00","#FFEA00","#FFD600"],amber:["#FFC107","#FFF8E1","#FFECB3","#FFE082","#FFD54F","#FFCA28","#FFC107","#FFB300","#FFA000","#FF8F00","#FF6F00","#FFE57F","#FFD740","#FFC400","#FFAB00"],orange:["#FF9800","#FFF3E0","#FFE0B2","#FFCC80","#FFB74D","#FFA726","#FF9800","#FB8C00","#F57C00","#EF6C00","#E65100","#FFD180","#FFAB40","#FF9100","#FF6D00"],deepOrange:["#FF5722","#FBE9E7","#FFCCBC","#FFAB91","#FF8A65","#FF7043","#FF5722","#F4511E","#E64A19","#D84315","#BF360C","#FF9E80","#FF6E40","#FF3D00","#DD2C00"],brown:["#795548","#EFEBE9","#D7CCC8","#BCAAA4","#A1887F","#8D6E63","#795548","#6D4C41","#5D4037","#4E342E","#3E2723"],grey:["#9E9E9E","#FAFAFA","#F5F5F5","#EEEEEE","#E0E0E0","#BDBDBD","#9E9E9E","#757575","#616161","#424242","#212121"]};var octemp=octemp||{};ocanMod.directive("ocDraggeble",function(){return{restrict:"A",scope:{dragData:"=",ocDraggeble:"=",ocStartdrag:"&",ocDragover:"&",ocDropover:"&"},link:function(scope,element){element.attr("draggable",scope.ocDraggeble);scope.$watch("ocDraggeble",function(value){element.attr("draggable",value)});element[0].addEventListener("dragstart",function(e){octemp.dragStartedElement=element;if(scope.dragData){octemp.dragStartedData=scope.dragData;e.dataTransfer.setData("transfer_data",JSON.stringify(scope.dragData))}else{octemp.dragStartedData=null}if(scope.ocStartdrag){scope.ocStartdrag({event:e})}},false);if(scope.ocDragover){element[0].addEventListener("dragover",function(e){var event={e:e};if(octemp.dragStartedData){event.dragData=octemp.dragStartedData}if(octemp.dragStartedElement){event.dragElement=octemp.dragStartedElement}scope.onDragover({event:event});if(e.preventDefault){e.preventDefault()}},false)}if(scope.ocDropover){if(!scope.ocDragover){element[0].addEventListener("dragover",function(e){if(e.preventDefault){e.preventDefault()}},false)}element[0].addEventListener("drop",function(e){if(scope.onDropOver){var event={e:e};if(octemp.dragStartedData){event.dragData=octemp.dragStartedData}if(octemp.dragStartedElement){event.dragElement=octemp.dragStartedElement}scope.onDropOver({event:event})}if(e.preventDefault){e.preventDefault()}},false)}}}});ocanMod.directive("ocDragDrop",function(){return{author:{name:"Özgür Çimen 2014",mail:"derozgur@gmail.com",web:"cimenozgur.com",},restrict:"A",scope:{onDropOver:"&",ocDragDrop:"=",transferData:"=",onDragEnd:"&",deactiveDrag:"="},link:function(scope,element,attrs,ctrl){if(!scope.deactiveDrag){element.attr("draggable","true")}element.attr("id",new Date().getTime());scope.$watch("ocDragDrop",function(value){element.attr("draggable",value)});dragel=element[0];var opa=element.css("opacity");dragel.addEventListener("dragstart",function(e){console.log("drag start");e.dataTransfer.setData("sourceId",element.attr("id"));e.dataTransfer.setData("transfer_data",JSON.stringify(scope.transferData));element.css("opacity",".3")},false);dragel.addEventListener("dragend",function(e){element.css("opacity",opa);if(scope.onDragEnd){scope.onDragEnd({event:e})}},false);dragel.addEventListener("dragover",function(e){if(e.preventDefault){e.preventDefault()}},false);if(scope.onDropOver){dragel.addEventListener("drop",function(e){var sourceId=e.dataTransfer.getData("sourceId")||"";var transferedData=e.dataTransfer.getData("transfer_data");transferedData=(transferedData!="undefined"&&transferedData!="")?JSON.parse(transferedData):"";var sourceElement=$("#"+sourceId)[0];var target;if(typeof $(e.target).attr("oc-drag-drop")=="undefined"){target=e.target.parentElement}else{target=e.target}scope.onDropOver({event:{data:transferedData,sourceElement:sourceElement,target:target}})},false)}}}});ocanMod.directive("ocMultiSelectBox",function(){var tpl='<div style="position:relative"><div class="receiver-holder {{formControlCSS}}" ><div ng-click="onclickItem({item:item});console.log(\'hoop\')" ng-repeat="item in model" class="oc-none-select receiver-item btn-sm {{(item.css) ? item.css :\'\'}} btn-addon"><i ng-click="onClickRemove($index)" class="fa fa-times pull-right"></i>{{item.title}}</div><input ng-readonly="readonly" style=" outline: none;" type="text" ng-model="searchText" placeholder="{{(model.length > 0 ) ? \'\' : ph}}"></div><ul class="oc-auto-list"><li ng-click="selectStaticItem($index)" ng-repeat="item in staticList" class="select-item static-item" data-index="{{$index}}"><i ng-if="item.icon" class="fa {{item.icon}} fa-fw text-muted"></i>&nbsp;{{item.title}}</li><li ng-click="selectItem(item)" ng-repeat="item in sourceData |filter:searchText | exclude:model" class="{{(item.type==\'divider\') ? \'divider\' : \'select-item\'}}" data-item="{{item}}">{{item.title}}</li></ul></div>';return{author:{name:"Özgür Çimen 2014",mail:"derozgur@gmail.com",web:"cimenozgur.com",},restrict:"E",link:function(scope,element,attrs,ctrl){if(typeof scope.border=="undefined"){scope.formControlCSS="form-control"}else{scope.formControlCSS=""}if(typeof scope.model=="undefined"){scope.model=[]}if(scope.model==null){scope.model=[]}var input=$(element).find("input").first();var list=$(element).find(".oc-auto-list");scope.searchText="";list.hide();scope.listElement=list;scope.input=input;scope.selectItem=function(item){if(item.type=="divider"){return}scope.model[scope.model.length]=item;scope.searchText="";scope.listElement.hide();scope.input.focus();if(scope.onChanged){scope.onChanged()}};scope.onClickRemove=function(index){if(scope.readonly){return}scope.model.splice(index,1);if(scope.onChanged){scope.onChanged()}scope.listElement.hide()};scope.selectStaticItem=function(index){if(scope.readonly){return}scope.searchText="";scope.listElement.hide();scope.input.focus();if(scope.onSelectStaticItem){scope.onSelectStaticItem({index:index})}};input[0].onkeydown=function(event){if(scope.readonly){return}scope.showList();var key=event.keyCode||event.charCode;if(key==40){if(list.is(":visible")){var items=list.find(".select-item");var found=false;items.each(function(index){if($(this).hasClass("selected")){found=true;if(index<items.length-1){$(this).removeClass("selected");$(items[index+1]).addClass("selected");var offsettop=(list[0].scrollHeight/(items.length*40))*(index*40);console.log(offsettop);list[0].scrollTop=offsettop}return false}});if(!found){$(items[0]).addClass("selected");list[0].scrollTop=0}}event.preventDefault();return false}if(key==38){if(list.is(":visible")){var items=list.find(".select-item");var found=false;items.each(function(index){if($(this).hasClass("selected")){found=true;if(0<index){$(this).removeClass("selected");$(items[index+-1]).addClass("selected");var offsettop=(list[0].scrollHeight/(items.length*40))*((index-1)*40);list[0].scrollTop=offsettop}return !found}})}event.preventDefault();return false}if(key==8||key==46){scope.$apply(function(){if(scope.model.length>0){if(scope.searchText.length==0){list.hide();scope.model.splice(scope.model.length-1,1);if(scope.onChanged){scope.onChanged()}}}else{scope.model=[]}})}if(key==13){if(list.is(":visible")){var items=list.find(".select-item.selected").first();if($(items[0]).hasClass("divider")){return}if(items.length>0){if($(items[0]).hasClass("static-item")){var indeX=$(items[0]).data("index");scope.selectStaticItem(indeX)}else{scope.$apply(function(){var itemData=$(items[0]).data("item");if(itemData.type=="divider"){return}var ix=scope.sourceData.map(function(x){return x.id}).indexOf(itemData.id);if(ix<0){return}scope.model[scope.model.length]=scope.sourceData[ix];scope.searchText="";scope.listElement.hide();scope.input.focus();if(scope.onChanged){scope.onChanged()}})}}}event.preventDefault();return false}};input[0].onclick=function(){if(scope.readonly){return}scope.showList()};function onInputBlur(){list.hide();input[0].onblur=null}input[0].onblur=onInputBlur;input[0].onmouseover=function(){input[0].onblur=onInputBlur};list[0].onmouseover=function(event){input[0].onblur=null;if(event.target){if(event.target.nodeName=="LI"||event.target.nodeName=="li"){if(!$(event.target).hasClass("selected")){list.find(".select-item").each(function(index){$(this).removeClass("selected")});$(event.target).addClass("selected")}}}};list[0].onmouseout=function(){input[0].onblur=onInputBlur};scope.showList=function(){list.show();input[0].onblur=onInputBlur}},scope:{ph:"@placeholder",model:"=ngModel",sourceData:"=",staticList:"=",onclickItem:"&",onSelectStaticItem:"&onselectStaticitem",border:"=",onChanged:"&",readonly:"="},template:tpl}});ocanMod.directive("ocBoostrapDatetimepicker",function(){return{author:{name:"Özgür Çimen 2014",mail:"derozgur@gmail.com",web:"cimenozgur.com",},restrict:"A",link:function(scope,element,attrs,ctrl){element.datetimepicker()}}});ocanMod.directive("ocBoostrapDaterangePicker",function($ocDateRangeDelegate){return{author:{name:"Özgür Çimen 2014",mail:"derozgur@gmail.com",web:"cimenozgur.com",},restrict:"A",scope:{onApply:"&",options:"=",onClear:"&",id:"@ocBoostrapDaterangePicker"},link:function(scope,element,attrs,ctrl){var dateRange=$(element);if(typeof scope.options=="object"){dateRange.daterangepicker(scope.options)}else{dateRange.daterangepicker()}dateRange.on("apply.daterangepicker",function(ev,picker){if(!scope.options.singleDatePicker){scope.model={start:picker.startDate._d,end:picker.endDate._d};if(scope.onApply){scope.onApply({dateRange:{start:picker.startDate._d,end:picker.endDate._d}})}}else{scope.model=picker.startDate._d;if(scope.onApply){scope.onApply({date:picker.startDate._d})}}scope.$apply()});dateRange.on("cancel.daterangepicker",function(ev,picker){if(scope.onClear){scope.onClear()}});if(scope.id){$ocDateRangeDelegate.set(scope.id,dateRange)}scope.$on("$destroy",function(){if(scope.id){$ocDateRangeDelegate.remove(scope.id)}})}}});ocanMod.directive("ocFullcalendar",function($timeout,$ocFullCalendarDelegate){return{author:{name:"Özgür Çimen 2014",mail:"derozgur@gmail.com",web:"cimenozgur.com",},restrict:"A",scope:{calendarId:"@ocFullcalendar",calenderOptions:"="},link:function(scope,element,attrs,ctrl){$(document).ready(function(){var calendar=$(element).fullCalendar(scope.calenderOptions);if(scope.calendarId){$ocFullCalendarDelegate._push(scope.calendarId,calendar)}})}}});ocanMod.directive("ocGmapPositionSelector",function($timeout,$ocMapDelegate){return{restrict:"A",scope:{mapId:"@ocGmapPositionSelector",onselect:"&",centerPos:"=",options:"=",model:"=ngModel",addMode:"=",onclickMarker:"&"},link:function(scope,element,attrs,ctrl){var options=scope.options||{};var map=null;if(typeof google=="undefined"){return}$timeout(function(){if(scope.centerPos){var center=new google.maps.LatLng(scope.centerPos.lat,scope.centerPos.lng);var zoom=14}else{var center={lat:39.2601934,lng:35.431615};var zoom=10}map=new google.maps.Map(element.context,{center:center,zoom:zoom,mapTypeId:google.maps.MapTypeId.ROADMAP});if(navigator.geolocation&&scope.centerPos==null){navigator.geolocation.getCurrentPosition(function(position){initialLocation=new google.maps.LatLng(position.coords.latitude,position.coords.longitude);map.setCenter(initialLocation)})}map.addListener("click",function(e){if(scope.addMode){if(map._proData.markers){for(var i=0;i<map._proData.markers.length;i++){map._proData.markers[i].setMap(null)}}placeMarkerAndPanTo(e.latLng,map)}});google.maps.event.trigger(map,"resize");map._proData={};if(scope.mapId){if(scope.onclickMarker){map._proData.onclickMarker=scope.onclickMarker}$ocMapDelegate.pushMap(scope.mapId,map)}if(!scope.options.searchDisable){initAutocomplete()}},300);function placeMarkerAndPanTo(latLng,map){if(scope.options.singlePointMode){if(map._proData.singleMarker){map._proData.singleMarker.setMap(null)}map._proData.singleMarker=new google.maps.Marker({position:latLng,map:map});if(scope.onselect){scope.onselect({position:{latitude:latLng.lat(),longitude:latLng.lng()}})}scope.$apply()}}scope.$on("$destroy",function(){$(element).remove();map=null;if(scope.mapId){$ocMapDelegate.removeMap(scope.mapId)}});function initAutocomplete(){var ainput=angular.element('<input id="pac-input" class="controls" type="text" placeholder="Ara">');$(element).parent().append(ainput);var input=ainput[0];var searchBox=new google.maps.places.SearchBox(input);map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);map.addListener("bounds_changed",function(){searchBox.setBounds(map.getBounds())});searchBox.addListener("places_changed",function(){var places=searchBox.getPlaces();if(places.length==0){return}var bounds=new google.maps.LatLngBounds();places.forEach(function(place){var icon={url:place.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};if(place.geometry.viewport){bounds.union(place.geometry.viewport)}else{bounds.extend(place.geometry.location)}});map.fitBounds(bounds)})}}}});ocanMod.directive("ocInfiniteScroll",function($ocScrollDelegate){return{author:{name:"Özgür Çimen 2014",mail:"derozgur@gmail.com",web:"cimenozgur.com",},restrict:"A",scope:{ocInfiniteScroll:"&",winscroll:"@"},link:function(scope,element,attrs,ctrl){function isScrolledIntoView(elem){var $elem=$(elem);var $window=$(window);var docViewTop=$window.scrollTop();var docViewBottom=docViewTop+$window.height();var elemTop=$elem.offset().top;var elemBottom=elemTop+$elem.height();return((elemBottom<=docViewBottom)&&(elemTop>=docViewTop))}$(element).css("height","10px");$(element).css("overflow","auto");$(element).css("overflow-x","hidden");$ocScrollDelegate.setAvailable(true);var target=element[0];console.log("wind",scope.winscroll);if(!scope.winscroll){$(element).parent().scroll(function(onscroll){if($ocScrollDelegate.getAvailable()){if(isScrolledIntoView(target)){$ocScrollDelegate.setAvailable(false);if(scope.ocInfiniteScroll){scope.ocInfiniteScroll()}}}})}else{window.onscroll=function(event){if($ocScrollDelegate.getAvailable()){if(isScrolledIntoView(target)){$ocScrollDelegate.setAvailable(false);if(scope.ocInfiniteScroll){scope.ocInfiniteScroll()}}}}}scope.$on("$destroy",function(){window.onscroll=null})}}});ocanMod.directive("ocSelect2",function($timeout){return{restrict:"A",scope:{ocSelect2:"&",model:"=ngModel"},link:function(scope,element,attrs,ctrl){$(element).select2();$timeout(function(){$(element).select2().val(scope.model)},200)}}});ocanMod.directive("ocTableSortable",function(){return{restrict:"A",scope:{ocTableSortable:"=",sortField:"@"},link:function(scope,element,attrs,ctrl){var target=angular.element(element);target.addClass("oc-sortable");$(element).find(".footable-sort-indicator").addClass("fa");resetHeaders();target.click(function(){if(target.hasClass("footable-sorted")){resetHeaders();target.addClass("footable-sorted-desc");target.removeClass("footable-sorted");var indacator=$(element).find(".footable-sort-indicator").first();if(indacator){indacator.removeClass("fa-sort");indacator.addClass("fa-caret-down")}scope.ocTableSortable=scope.sortField;scope.$apply()}else{resetHeaders();target.removeClass("footable-sorted-desc");target.addClass("footable-sorted");var indacator=$(element).find(".footable-sort-indicator").first();if(indacator){indacator.removeClass("fa-sort");indacator.addClass("fa-caret-up")}scope.ocTableSortable="-"+scope.sortField;scope.$apply()}});function resetHeaders(){target.parent().find(".oc-sortable").removeClass("footable-sorted-desc footable-sorted");var indacator=target.parent().find(".oc-sortable").find(".footable-sort-indicator");if(indacator){indacator.removeClass("fa-caret-up");indacator.removeClass("fa-caret-down");indacator.addClass("fa-sort")}}}}});ocanMod.filter("estimateTime",function(){return function(value,params){if(typeof value!="number"||typeof value=="undefined"){return value}var ds="gün";var hs="saat";var ms="dakika";var ss="saniye";if(params){if(params.shorted){ms="dak";ss="san"}}var result="";var x=value/1000;var s=Math.floor(x%60);x/=60;var m=Math.floor(x%60);x/=60;var h=Math.floor(x%24);x/=24;var d=Math.floor(x);if(d>0){result=d+" "+ds+" "}if(h>0){result+=h+" "+hs+" "}if(m>0){result+=m+" "+ms+" "}if(s>0){result+=s+" "+ss+" "}return result}});ocanMod.filter("exclude",function(){return function(items,excludes){if(typeof items=="undefined"){return}if(typeof excludes=="undefined"){return items}var result=[];for(var i=0;i<items.length;i++){var item=items[i];if(excludes.indexOf(item)<0){result.push(item)}else{for(var k=0;k<excludes.length;k++){var exclude=excludes[k]}}}return result}});ocanMod.service("$ocDateRangeDelegate",function($timeout){var delegates=[];this.set=function(id,range){delegates[id]=range};this.getDatePicker=function(id){console.log(delegates[id]);if(delegates[id]==null){$timeout(function(){return delegates[id]},200)}else{return delegates[id]}};this.remove=function(id){if(delegates[id]){delegates[id]=null}delete delegates[id]}});ocanMod.service("$ocFullCalendarDelegate",function($q,$timeout){var delegates=[];function CalendarDelagete(id){var calendar=delegates[id];var _p=this;_p.addEvents=function(events){if(!events||events.length<=0){return}calendar.fullCalendar("addEventSource",{events:events});calendar.fullCalendar("rerenderEvents")};_p.removeEvents=function(events){calendar.fullCalendar("removeEventSource",events)};_p.changeView=function(viewName){calendar.fullCalendar("changeView",viewName)};_p.getView=function(){return calendar.fullCalendar("getView")};_p.gotoDate=function(date){calendar.fullCalendar("gotoDate",date)};_p.getEvents=function(){return calendar.fullCalendar("clientEvents")}}this._push=function(id,com){delegates[id]=com};this._remove=function(id){if(delegates[id]){delegates[id]=null}delete delegates[id]};this.getDelegate=function(id){var deffered=$q.defer();$(document).ready(function(){$timeout(function(){if(delegates[id]!=null){deffered.resolve(new CalendarDelagete(id))}else{deffered.reject("calendar could not be found "+id)}},200)});return deffered.promise}});ocanMod.service("$ocMapDelegate",function($timeout,$compile){var maps=[];function MapDelagete(id){var _p=this;var markerClusterEnabled=false;var typedCluster=[];mc=null;if(typeof google=="undefined"){return}var infowindow=new google.maps.InfoWindow();var _bound_callback;_p.addAreaEvent=function(callback){if(maps[id]==null){$timeout(function(){if(maps[id]==null){$timeout(_apply,1500)}else{_apply()}},1700)}else{_apply()}function _apply(){_bound_callback=callback;google.maps.event.addListener(maps[id],"bounds_changed",boundChanged);console.log("bound event added")}};_p.setCenter=function(pos){if(maps[id]==null){$timeout(function(){if(maps[id]==null){$timeout(_apply,1500)}else{_apply()}},1700)}else{_apply()}function _apply(){var lat,lng;if(pos.lat&&pos.lng){console.warn("Use $ocMapDelegate.setCenter({latitude,longitude}) instead of {lat,lng} is deprecieted");lat=pos.lat;lng=pos.lng}else{if(pos.latitude&&pos.longitude){lat=pos.latitude;lng=pos.longitude}}maps[id].setCenter(new google.maps.LatLng(lat,lng))}};_p.isInMapArea=function(latitude,longitude){var b=maps[id].getBounds();var start={x:b.getNorthEast().lat(),y:b.getNorthEast().lng()};var end={x:b.getSouthWest().lat(),y:b.getSouthWest().lng()};if(latitude<=start.x&&longitude<=start.y&&latitude>=end.x&&longitude>=end.y){return true}return false};_p.setZoom=function(value){if(maps[id]!=null){maps[id].setZoom(value)}};_p.addMarker=function(mark){if(maps[id]==null){$timeout(function(){if(maps[id]==null){$timeout(_apply,1500)}else{_apply()}},1700)}else{_apply()}function _apply(){if(maps[id]!=null){var map=maps[id];if(map._proData.markers==null){map._proData.markers=[]}if(mark.position){var marker=new google.maps.Marker({position:new google.maps.LatLng(mark.position.lat,mark.position.lng),map:map,title:mark.title,data:mark,icon:mark.icon});map._proData.markers.push(marker);if(mark.type&&markerClusterEnabled){if(typedCluster[mark.type]){typedCluster[mark.type].addMarker(marker)}}google.maps.event.addListener(marker,"click",function(event){if(map._proData.onclickMarker){return map._proData.onclickMarker({marker:this})}if(infowindow){infowindow.close()}if(this.data.infoContent){infowindow.setContent(this.data.infoContent);infowindow.open(map,this)}else{if(this.data.title){infowindow.setContent("<div><strong>"+this.data.title+"</strong><br>");infowindow.open(map,this)}}})}}}};_p.setMarkers=function(markers,clear){if(maps[id]==null){$timeout(function(){if(maps[id]==null){$timeout(_apply,1500)}else{_apply()}},1700)}else{_apply()}function _apply(){if(maps[id]!=null&&markers!=null){var map=maps[id];if(clear){_p.clearMarkers()}var tmpMarkers=null;if(map._proData.markers==null){map._proData.markers=[]}else{tmpMarkers=[]}for(var i=0;i<markers.length;i++){var mark=markers[i];if(mark.position){var marker=new google.maps.Marker({position:new google.maps.LatLng(mark.position.lat,mark.position.lng),map:map,title:mark.title,data:mark,icon:mark.icon});map._proData.markers.push(marker);if(mark.type&&markerClusterEnabled){if(typedCluster[mark.type]){typedCluster[mark.type].addMarker(marker)}}if(tmpMarkers){tmpMarkers.push(marker)}google.maps.event.addListener(marker,"click",function(event){if(map._proData.onclickMarker){return map._proData.onclickMarker({marker:this})}if(infowindow){infowindow.close()}if(this.data.infoContent){infowindow.setContent(this.data.infoContent);infowindow.open(map,this)}else{if(this.data.title){infowindow.setContent("<div><strong>"+this.data.title+"</strong><br>");infowindow.open(map,this)}}})}}tmpMarkers=null}else{console.warn("map not found",id)}}};function boundChanged(){if(_bound_callback){_bound_callback(maps[id].getBounds())}}_p.getMap=function(){if(maps[id]==null){return console.warn("map not found",id)}return maps[id]};_p.enableMarkerCluster=function(type){if(maps[id]==null){return console.warn("map not found",id)}var _map=maps[id];var mcOptions={gridSize:28,maxZoom:16,imagePath:"assets/img/m"};mcOptions.zoomOnClick=false;typedCluster[type]=new MarkerClusterer(_map,[],mcOptions);for(var i=0;i<_map._proData.markers.length;i++){var marker=_map._proData.markers[i];if(marker.data&&marker.data.type&&marker.data.type==type){typedCluster[type].addMarker(marker)}}markerClusterEnabled=true};_p.getAllClusters=function(){if(maps[id]==null){return console.warn("map not found",id)}if(!mc){return}return mc.clusters_};_p.addClusterEvent=function(type,eventName,callback){if(maps[id]==null){return console.warn("map not found",id)}if(typedCluster[type]){google.maps.event.addListener(typedCluster[type],eventName,callback)}};_p.removeClusterEvent=function(eventName,callback){if(maps[id]==null){return console.warn("map not found",id)}if(!mc){return}google.maps.event.removeListener(mc,eventName,callback)};_p.getMarkers=function(){if(maps[id]==null){return console.warn("map not found",id)}var _map=maps[id];if(_map._proData.markers){return _map._proData.markers}return null};_p.openInfoWindow=function(marker,content){if(maps[id]==null){return console.warn("map not found",id)}var _map=maps[id];if(infowindow){infowindow.close()}infowindow.setContent(content);infowindow.open(_map,marker);return function(id,s){if(id&&s){$compile($("#"+id)[0])(s)}return infowindow}};_p.clearByType=function(type){if(maps[id]==null){return console.warn("map not found",id)}var _map=maps[id];if(_map._proData.markers){var k=_map._proData.markers.length;var a=0;if(typedCluster[type]){typedCluster[type].clearMarkers()}while(k--){if(_map._proData.markers[k].data&&_map._proData.markers[k].data.type&&_map._proData.markers[k].data.type==type){_map._proData.markers[k].setMap(null);_map._proData.markers[k]=null;_map._proData.markers.splice(k,1);k=_map._proData.markers.length}}}};_p.clearMarkers=function(){if(maps[id]==null){return console.warn("map not found",id)}var _map=maps[id];for(var i=0;i<typedCluster.length;i++){typedCluster[i].clearMarkers();typedCluster[i]=null}if(_map._proData.markers){for(var i=0;i<_map._proData.markers.length;i++){_map._proData.markers[i].setMap(null)}_map._proData.markers=null;_map._proData.markers=[]}if(_map._proData.singleMarker){_map._proData.singleMarker.setMap(null)}_map._proData.singleMarker=null}}this.pushMap=function(id,map){maps[id]=map};this.removeMap=function(id){if(maps[id]){maps[id]=null}delete maps[id]};this.getMapDelegate=function(id){return new MapDelagete(id)}});ocanMod.factory("$ocPopup",function($rootScope,$timeout,$q,$compile,$templateRequest,$controller,$window){var OcPopup=function(options){var deffered=$q.defer();var _p=this;var posx=0;var posy=0;var swMargin=oc.getScrollBarWidth();_p.close=function(val){$("body").removeClass("modal-open");$(document).off("mousedown",onmouseActive);$(backDrop).remove();deffered.resolve(val)};if(options.event){var $event=options.event;posx=$event.pageX;posy=$event.pageY}var _st1,_st2,popup;var modalScope=null;var ctrlLocals={};if(options.resolve){for(fn in options.resolve){ctrlLocals[fn]=options.resolve[fn].apply()}}ctrlLocals["$ocPopupInstance"]={close:_p.close};if(options.controller){modalScope=$rootScope.$new();ctrlLocals.$scope=modalScope;var ctrlInstance=$controller(options.controller,ctrlLocals)}var windowClass=options.windowClass||"";if(options.minWidth&&!options.minHeight){_st1="style='min-width:"+options.minWidth+"px;'"}if(!options.minWidth&&options.minHeight){_st1="style='min-height:"+options.minHeight+"px;'"}if(options.minWidth&&options.minHeight){_st1="style='min-width:"+options.minWidth+"px; min-height:"+options.minHeight+"px'"}if(_st1){popup=angular.element("<div "+_st1+" class='"+windowClass+" oc-free-com oc-popup-content'></div>")}else{popup=angular.element("<div class='"+windowClass+" oc-free-com oc-popup-content'></div>")}var backDrop=null;if(options.blackBack){backDrop=angular.element("<div class='oc-full-component black-shadow'></div>")}else{backDrop=angular.element("<div class='oc-full-component'></div>")}backDrop.append(popup);$("body").addClass("modal-open");$("body").append(backDrop);if(options.templateUrl&&options.templateUrl.length>0){$templateRequest(options.templateUrl).then(function(resp){popup.html(resp);if(modalScope){$compile(popup)(modalScope)}else{if(options.scope){$compile(popup)(options.scope)}}$timeout(function(){$(popup).ready(function(){console.log("popupwith",popup.width());if(posx+popup.width()+50>$window.innerWidth){posx=posx-popup.width()}if(posy+popup.height()+50>$window.innerHeight){posy=posy-popup.height()}posy=(posy<0)?0:posy;$(popup).css("top",posy+"px");$(popup).css("left",posx+"px");$(popup).addClass("oc-fade-in");$(document).on("mousedown",onmouseActive)})},100)},function(err){console.error("Template cannot load",err)})}function onmouseActive(event){if($(backDrop).find(event.target).length==0){_p.close()}}var pro=deffered.promise;pro.close=_p.close;return pro};return{show:function(options){return new OcPopup(options)}}});ocanMod.service("$ocScrollDelegate",function(){var scrollAvailable=false;this.infiniteScrollComplete=function(){scrollAvailable=true};this.setAvailable=function(value){scrollAvailable=value};this.getAvailable=function(){return scrollAvailable}});